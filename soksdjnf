import json
from menu import menu  # Import menu from menu.py

def get_item_details(item_name):
    """Fetches the description and available modifications for a menu item."""
    
    # Ensure the item exists and is a dictionary
    item = item_name.strip().lower()

    if item not in menu:
        return f"Error: '{item}' not found in the menu. Available items: {', '.join(menu.keys())}"

    details = menu[item]

    if not isinstance(details, dict):
        return f"Error: '{item}' is not stored correctly. Expected a dictionary, but found {type(details)}."

    description = details.get("description", "No description available.")
    modifications = ", ".join(details.get("modifications", [])) if "modifications" in details else "None"

    return (
        f"\nItem: {item.capitalize()}\n"
        f"Description: {description}\n"
        f"Possible modifications: {modifications}\n"
        f"Price: ${details.get('price', 'Unknown'):.2f}"
    )

# --- Debugging Code ---

# Check menu structure
print("\nChecking menu structure...")

if not isinstance(menu, dict):
    print("Error: 'menu' is not a dictionary!")
else:
    print(f"Menu loaded successfully with {len(menu)} items.\n")

# Allow user to test item lookup
while True:
    item_name = input("\nEnter an item name (or 'exit' to quit): ").strip()
    if item_name.lower() == "exit":
        print("Exiting...")
        break

    print(get_item_details(item_name))
